- alias: Turn porch light on when armed home
  initial_state: true
  trigger:
  - platform: state
    entity_id: alarm_control_panel.abode
    to: 'armed_home'
  - platform: time
    at: '22:00:00'
  condition:
  - condition: time
    after: '22:00:00'
    before: '05:00:00'
  - condition: state
    entity_id: alarm_control_panel.abode
    state: 'armed_home'
  action:
  - service: light.turn_on
    data:
      entity_id: light.porch_light
      kelvin: 4000
      brightness_pct: 50


- alias: Toggle vacation mode
  initial_state: true
  trigger:
  - platform: state
    entity_id: alarm_control_panel.abode
    to: 'armed_away'
    for: '24:00:00'
  - platform: state
    entity_id: alarm_control_panel.abode
    from: 'armed_away'
    to: 'disarmed'
  action:
  - service_template: "{{ 'input_boolean.turn_on' if is_state('alarm_control_panel.abode', 'armed_away') else 'input_boolean.turn_off' }}"
    entity_id: input_boolean.vacation_mode


- alias: Vacation mode lights on
  initial_state: true
  trigger:
  - platform: time
    at: '21:00:00'
  condition:
  - condition: state
    entity_id: input_boolean.vacation_mode
    state: 'on'
  action:
  - delay:
      seconds: "{{ range(0,600) | random | int }}"
  - service: hue.hue_activate_scene
    data:
      group_name: Living room
      scene_name: Read


- alias: Vacation mode photo
  initial_state: true
  trigger:
  - platform: time
    at: '22:00:00'
  condition:
  - condition: state
    entity_id: input_boolean.vacation_mode
    state: 'on'
  action:
    service: abode.trigger_quick_action
    entity_id: binary_sensor.photo


- alias: Vacation mode lights off
  initial_state: true
  trigger:
  - platform: time
    at: '22:45:00'
  condition:
  - condition: state
    entity_id: input_boolean.vacation_mode
    state: 'on'
  action:
  - delay:
      seconds: "{{ range(0,600) | random | int }}" 
  - service: light.turn_off
    entity_id: all


- alias: Turn lights on when alarm triggered
  initial_state: true
  trigger:
  - platform: event
    event_type: abode_alarm
  condition:
  - condition: state
    entity_id: alarm_control_panel.abode
    state: armed_away
  - condition: state
    entity_id: binary_sensor.dark_inside
    state: 'on'
  action:
  - service: hue.hue_activate_scene
    data:
      group_name: Living room
      scene_name: Red
  - service: hue.hue_activate_scene
    data:
      group_name: Dining room
      scene_name: Read
  - service: hue.hue_activate_scene
    data:
      group_name: Game room
      scene_name: Red
  - service: hue.hue_activate_scene
    data:
      group_name: Master bedroom
      scene_name: Red