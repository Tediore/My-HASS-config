tts_living_room:
  sequence:
  - service: media_player.volume_mute
    entity_id: media_player.living_room_speaker
    data:
      is_volume_muted: true
  - service: media_player.turn_on
    entity_id: media_player.living_room_speaker
  - wait_template: "{{ is_state('media_player.living_room_speaker', 'idle') }}"
    timeout: '00:00:20'
    continue_on_timeout: true
  - delay: '00:00:01'
  - service: media_player.volume_mute
    entity_id: media_player.living_room_speaker
    data:
      is_volume_muted: false
  - service: tts.google
    entity_id: media_player.living_room_speaker
    data_template:
      message: "{{ message }}"
  - wait_template: "{{ is_state('media_player.living_room_speaker', 'playing') }}"
    timeout: '00:00:10'
    continue_on_timeout: true
  - wait_template: "{{ is_state('media_player.living_room_speaker', 'idle') }}"
    timeout: '00:00:10'
    continue_on_timeout: true
  - service: media_player.turn_off
    entity_id: media_player.living_room_speaker