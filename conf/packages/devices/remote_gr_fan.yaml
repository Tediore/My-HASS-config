automation:
- alias: Game room fan remote
  initial_state: true
  mode: parallel
  trigger:
  - platform: mqtt
    topic: zigbee2mqtt/Game room fan remote/click
    # first button: turn fan on
    # third button: change fan speed
  action:
  - choose:
    - conditions:
      - condition: template
        value_template: "{{ trigger.payload == 'power' }}"
      sequence:
      - service_template: "{{ 'fan.turn_on' if is_state('climate.game_room_fan', 'off') else 'climate.turn_off' }}"
        data_template:
          entity_id: "{{ 'fan.game_room' if is_state('climate.game_room_fan', 'off') else 'climate.game_room_fan' }}"
    - conditions:
      - condition: template
        value_template: "{{ trigger.payload == 'colortemp' }}"
      sequence:
      - service: script.ir_fan_speed
        data:
          blaster: game_room_ir